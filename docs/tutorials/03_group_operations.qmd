---
title: "Group Operations"
execute:
  enabled: false
---

Sector-relative operations: `group_rank`, `group_neutralize`, and more.

```{python}
#| eval: false
from alphalab.api.client import AlphaLabClient
import os

data_path = os.environ.get("LOCAL_STORAGE_PATH", "/path/to/your/data")
client = AlphaLabClient(data_path=data_path)

# Use a small subset for tutorials
SYMBOLS = ["AAPL", "MSFT", "GOOGL", "AMZN", "META", "NVDA", "TSLA", "JPM", "V", "JNJ"]
START = "2024-01-01"
END = "2024-12-31"
```

## Group Fields

Available group fields: `sector`, `industry`, `subindustry`, `exchange`.

## group_rank

Rank within each group instead of across all securities.

```{python}
#| eval: false
# Rank momentum within each sector
# This finds the best momentum stocks relative to their sector peers
alpha = client.query("""
momentum = ts_delta(close, 20);
group_rank(momentum, sector)
""", symbols=SYMBOLS, start=START, end=END)
print(alpha.head())
```

## group_neutralize

Subtract group mean to remove sector bias.

```{python}
#| eval: false
# Sector-neutralized momentum
# Removes sector momentum, keeping only stock-specific signal
alpha = client.query("""
momentum = ts_delta(close, 20);
group_neutralize(momentum, sector)
""", symbols=SYMBOLS, start=START, end=END)
print(alpha.head())
```

## Combining Group Operations

```{python}
#| eval: false
# Industry-relative value within sectors
# 1. Neutralize by sector to remove sector effects
# 2. Rank within industry for finer-grained comparison
alpha = client.query("""
value = 1 / close;
sector_neutral = group_neutralize(value, sector);
group_rank(sector_neutral, industry)
""", symbols=SYMBOLS, start=START, end=END)
print(alpha.head())
```

## Next Steps

- [Quickstart](01_quickstart.qmd) — Basic AlphaLab usage
- [Alpha Expressions](02_expressions.qmd) — Multi-line expressions with variables
- [Standalone DSL](04_standalone_dsl.qmd) — Use DSL with your own DataFrames
